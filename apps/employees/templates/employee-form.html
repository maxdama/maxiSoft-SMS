{% extends "layouts/base.html" %}

{% block title %} Guardian Forms {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}

    <style class="">
    .file {
      visibility: hidden;
      position: absolute;
    }

    .div-btn{
    color: #333;
    background-color: #fff;
    border-color: #ccc;
    }

    .div-btn:hover{
        color: #333;
        background-color: rgba(236, 234, 234, 0.99);
        border-color: rgba(173, 173, 173, 0.98);
    }

    .swal-title {
      margin: 0px;
      font-size: 23px;
      box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.21);
      margin-bottom: 28px;
        text-align: -moz-center;
    }

    .swal-text {
      background-color: rgb(255, 255, 255);
      padding: 17px;
      border: 1px solid rgba(240, 225, 161, 0.94);
      display: block;
      margin: 22px;
      text-align: center;
      color: #61534e;
      font-size: 17px;
    }

    .swal-footer {
      background-color: rgb(245, 248, 250);
      margin-top: 32px;
      border-top: 4px solid #E9EEF1;
      overflow: hidden;
    }

    </style>

{% endblock stylesheets %}

{% load static %}

{% block content %}

	<div class="content">
        <div class="page-inner">

            <form action="" class="" method="POST" enctype="multipart/form-data">
                {% csrf_token %}

                <div class="form-row col-md-3 d-none" >
                    <label for="gad_id">Employee ID</label>
                    <input type="text" class="form-control form-control-sm" id="gad_id" name="gad_id" value="{{guardian.pk}}">
			    </div>

                <div class="container" >
                    <div class="card border" >
                        <!-- Card Body  Employee to Assign  -->
                        <div class="card-body">
                            <div class="row ">
                                <!-- Column for Employee Name and Address Controls  -->
                                <div class="col col-sm-8 ">
                                    <div class="">
                                        <h3 class="pl-5 ml-4 text-success header"><strong>{{header}}</strong></h3>
                                        <p>

                                        <div class="row justify-content-center ">

                                            <div class="col-md-2 form-floating-label" hidden >
                                                <input type="text" class="form-control input-border-bottom pb-1" id="emp_id" name="id" value="{{emp.id}}"  >
                                                <label for="emp_id" class="placeholder">Employee ID</label>
                                            </div>

                                            <div class="col-md-5 no-bd no-box-shadow   pt-2">

                                                <label for="staff_no" class="placeholder font-italic  ">Staff No:</label>
                                                <input id="staff_no" name="staff_no" readonly  type="text" value="{{emp.staff_no}}" class="fw-extrabold  input-border-bottom pb-0">

                                            </div>
                                            <input id="emp-pic" type="file" name="emp_pic" class="file" accept="image/*" >

                                            <div class="col-4  m-0 p-0  ">
                                                <div class="row justify-content-center">
                                                    <div class="browse col justify-content-center border div-btn">
                                                        <div class="avatar avatar-xxl ml-5 ">
                                                            {% if emp.emp_pic %}
                                                                <img id="preview_edit" src="{{emp.emp_pic.url}}" alt="..." class="avatar-img rounded-circle ">
                                                            {% else %}
                                                                <img id="preview" src="/static/assets/img/default.png" alt="..." class="avatar-img rounded-circle">
                                                            {% endif %}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col text-sm-center clear-img div-btn">
                                                        <span class="text-small font-italic"> Clear Picture </span>
                                                    </div>
                                                </div>
                                                <input id="emp_pic_default" hidden type="text" class="" name="emp_pic_default" value="">
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <div class="col col-4  ">
                                    <!--  Close button at the TOP Right Corner. Closes the form to Employee List -->
                                    <button id="close" class=" btn  btn-outline-dark  btn-rounded btn-sm float-lg-right alert-success "  type="button" >X</button>
                                </div>

                            </div>
                        </div>

                        <div class="row d-flex justify-content-center">
                            <div class="col col-md-10">
                                <div class="card border">
                                    <!-- Card Header Employee Details-->
                                    <div class="card-header pt-1 pb-1 ">
                                        <div class="card-title card-success ">
                                            <h4>Bio Data and Contact</h4>
                                        </div>
                                    </div>
                                     <!-- Card Body Employee Details -->
                                    <div class="card-body">
                                        <!-- Column Rows Left Justification  -->
                                        <div class="row d-flex justify-content-left text-left pb-3">
                                            <div class="col-2 ">
                                                <div class="form-group form-floating-label">
                                                    <select class="form-control input-border-bottom pb-1" id="title" name="title" >
                                                        <option value="{{emp.title|default_if_none:''}}" hidden>{{emp.title|default_if_none:''}}</option>
                                                        <option></option>
                                                        <option>Chief</option>
                                                        <option>Mr</option>
                                                        <option>Ms</option>
                                                        <option>Miss</option>
                                                        <option>Mrs</option>
                                                        <option>Dr</option>
                                                        <option>Dr Ms</option>
                                                        <option>Prof.</option>
                                                        <option>Prof Dr</option>
                                                        <option>Mx</option>
                                                    </select>
                                                    <label for="title" class="placeholder">Title:</label>
                                                </div>
                                            </div>

                                            <div class="col-3 ">
                                                <div class="form-group form-floating-label">
                                                    <input  id="surname" type="text" value="{{emp.surname}}" name="surname" style="font-weight:bold; font-size: 17px;" class="pb-0 form-control input-border-bottom"  required>
                                                    <label for="surname" class="placeholder">* Surname</label>
                                                </div>
                                            </div>

                                            <div class="col-4">
                                                <div class="form-group form-floating-label">
                                                    <input id="other_names" type="text" value="{{emp.other_names|default_if_none:''}}" name="other_names" style="font-weight:bold; font-size: 17px;" class="pb-0 form-control input-border-bottom" required>
                                                    <label for="other_names" class="placeholder">* Other Names</label>
                                                </div>
                                            </div>

                                            <div class="col-3">
                                                <div class="form-group form-floating-label">
                                                    <input id="dob" type="date" name="dob" value="{{emp.dob|date:'Y-m-d'}}" style="font-weight:bold; font-size: 16px;" class="pb-0 form-control input-border-bottom"  required>
                                                    <label for="dob" class="placeholder">* Birth Date</label>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row d-flex justify-content-left text-left pb-3">
                                            <div class="col-2 ">
                                               <div class="form-group form-floating-label">
                                                <select id="gender" name="gender" class="form-control input-border-bottom pb-1 "  required>
                                                    <option value="{{emp.gender}}" hidden>{{emp.gender|default_if_none:''}}</option>
                                                    <option>Male</option>
                                                    <option>Female</option>
                                                </select>
                                                <label for="gender" class="placeholder">* Gender</label>
                                                </div>
                                            </div>

                                            <div class="col-3">
                                                <div class="form-group form-floating-label">
                                                    <input type="tel" id="phone1" value="{{emp.mobile_no1|default_if_none:''}}" class="pb-0 form-control input-border-bottom" name="mobile_no1" Required >
                                                    <label for="phone1" class="placeholder">* Mobile No:</label>
                                                </div>
                                            </div>

                                            <div class="col-3">
                                                <div class="form-group form-floating-label">
                                                    <input type="tel" id="phone2" value="{{emp.mobile_no2|default_if_none:''}}" class="pb-0 form-control input-border-bottom" name="mobile_no2"  >
                                                    <label for="phone2" class="placeholder">Phone No:</label>
                                                </div>
                                            </div>

                                            <div class="col-4 ">
                                                <div class="form-group form-floating-label">
                                                    <input id="email_addr" value="{{emp.email_addr|default_if_none:''}}" name="email_addr" type="text" class="pb-0 form-control input-border-bottom" >
                                                    <label for="email_addr" class="placeholder">Email</label>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row d-flex justify-content-center text-left pb-3">

                                            <div class="col-5">
                                                <div class="form-group form-floating-label">
                                                    <input id="resid_addr" type="text" value="{{emp.resid_addr|default_if_none:''}}" name="resid_addr" class="pb-0 form-control input-border-bottom">
                                                    <label for="resid_addr" class="placeholder">Residential Addr:</label>
                                                </div>
                                            </div>

                                            <!-- Guardian Residence City  -->
                                            <div class="col-sm-3 ">
                                                <div class="form-group form-floating-label">
                                                    <select class="form-control input-border-bottom pb-1" id="city" name="resid_city" >
                                                        <option value="{{emp.resid_city}}" hidden> {{emp.resid_city|default_if_none:''}}</option>
                                                        <option>Port Harcourt</option>
                                                        <option>Ahoada</option>
                                                        <option>Emoha</option>
                                                    </select>
                                                    <label for="city" class="placeholder">City Residence:</label>
                                                </div>
                                            </div>

                                            <div class="col-2 ">
                                                <div class="form-group form-floating-label">
                                                    <select class="form-control input-border-bottom pb-1" id="state"  name="resid_state">
                                                    <option value="{{emp.resid_state}}" hidden>{{emp.resid_state|default_if_none:''}}</option>
                                                    <option>Rivers</option>
                                                    <option>Bayelsa</option>
                                                    <option>Kwara</option>
                                                    <option>Niger</option>
                                                    <option>Adamawa</option>
                                                    <option>Yola</option>
                                                    <option>Kogi</option>
                                                    <option>Plateau</option>
                                                    </select>
                                                    <label for="state" class="placeholder">State Residence</label>
                                                </div>
                                            </div>

                                        </div>
                                         <div class="row d-flex justify-content-center text-left  border-top-1">
                                             <!-- Employee Marital Status -->
                                            <div class="col-sm-3 ">
                                                <div class="form-group form-floating-label">
                                                    <select class="form-control input-border-bottom pb-1" id="marital_status" name="marital_status" style="font-weight:bold;">
                                                        <option value="{{emp.marital_status}}" hidden> {{emp.marital_status|default_if_none:''}}</option>
                                                        <option>Married</option>
                                                        <option>Single</option>
                                                    </select>
                                                    <label for="city" class="placeholder">Marital Status:</label>
                                                </div>
                                            </div>

                                              <!-- Employee Has Next of Kin?
                                            <div class="col-sm-2 ">
                                                <div class="form-group form-floating-label">
                                                    <select required class="form-control input-border-bottom pb-1" id="has_nextkin" name="has_nextkin" style="font-weight:bold;">
                                                        <option  hidden> {{emp.has_nextkin|default_if_none:''}}</option>
                                                        <option>Yes</option>
                                                        <option>No</option>
                                                    </select>
                                                    <label for="has_nextkin" class="placeholder">Has Next of Kin?</label>
                                                </div>
                                            </div> -->

                                         </div>

                                    </div>

                                     <!-- Sub Header Employee Position ____________________________________________ -->
                                    <div class="card-sub mb-0 pb-0">
                                        <div class="row pb-0"><div class="col card-success">Employment</div></div>
                                    </div>
                                    <div class="card-body  pb-1">
                                        <div class="row d-flex justify-content-center text-left pb-0 mb-0 ">

                                            <div class="col-3">
                                                <div class="form-group form-floating-label">
                                                    <input required id="hire_date" type="date" name="hire_date" value="{{emp.hire_date|date:'Y-m-d'}}"  class="pb-0 pt-1 form-control input-border-bottom">
                                                    <label for="hire_date" class="placeholder pb-0">* Hired Date</label>
                                                </div>
                                            </div>

                                            <!-- Employee Position -->
                                            <div class="col-sm-3 ">
                                                <div class="form-group form-floating-label">
                                                    <select required class="form-control input-border-bottom pb-1 pt-2" id="position" name="group" >
                                                        <option value="{{emp.group_id}}" hidden> {{emp.group.name|default_if_none:''}}</option>
                                                        {% for posx in positions %}
                                                            <option value="{{posx.id}}" >{{posx.name}}</option>
                                                        {% endfor %}
                                                        <option disabled> ────────────── </option>
                                                        <option value="0">*  Add Position </option>
                                                    </select>
                                                    <label for="position" class="placeholder">Position</label>
                                                </div>
                                            </div>

                                            <!-- Employee Depoartment -->
                                            <div class="col-sm-3 ">
                                                <div class="form-group form-floating-label">
                                                    <select class="form-control input-border-bottom pb-1 pt-2" id="department" name="department" >
                                                        <option value="{{emp.department_id}}" hidden> {{emp.department.name|default_if_none:''}}</option>
                                                        {% for dept in departments %}
                                                            <option value="{{dept.id}}">{{dept.name}}</option>
                                                        {% endfor %}
                                                        <!-- <option value="-1" class="">-------------------------------</option> -->
                                                         <option disabled> ─────────────── </option>
                                                        <option value="0">* Add Department</option>
                                                    </select>
                                                    <label for="department" class="placeholder">Department</label>
                                                </div>
                                            </div>

                                            <!-- Employee Status -->
                                            <div class="col-sm-2 ">
                                                <div class="form-group form-floating-label">
                                                    <select class="form-control input-border-bottom pb-1 pt-2" id="status" name="status" required >
                                                        <option value="{{emp.status}}" hidden> {{emp.status|default_if_none:''}}</option>
                                                        <option>Active</option>
                                                        <option>Resigned</option>
                                                        <option>Terminated</option>
                                                        <option>On-Leave</option>
                                                        <option>On-Training</option>
                                                    </select>
                                                    <label for="status" class="placeholder">Status</label>
                                                </div>
                                            </div>

                                        </div>

                                    </div>

                                    <!-- Sub Header Next of Kin _________________________________________________   -->
                                    <div class="card-sub mb-0 pb-0">
                                        <div class="row">
                                            <div class="col card-success">Next of Kin Details:</div>
                                        </div>
                                    </div>

                                    <div class="card-body pb-0" >
                                        <!--  Next of Kin.  Column Rows Left Justification  -->
                                        <div class="row d-flex justify-content-left text-left pb-3" disbled>
                                            <div class="col-2 ">
                                                <div class="form-group form-floating-label">
                                                    <select class="form-control input-border-bottom pb-1" id="title_k" name="title_k" >
                                                        <option  hidden>{{emp.nextofkin.title_k|default_if_none:""}}</option>
                                                        <option></option>
                                                        <option>Mr</option>
                                                        <option>Mrs</option>
                                                        <option>Miss</option>
                                                        <option>Chief</option>
                                                    </select>
                                                    <label for="title_k" class="placeholder">Title:</label>
                                                </div>
                                            </div>

                                            <div class="col-3 ">
                                                <div class="form-group form-floating-label">
                                                    <input  id="surname_k" type="text" value="{{emp.nextofkin.surname_k|default_if_none:''}}" name="surname_k" style="font-weight:bold; font-size: 17px;" class="pb-0 form-control input-border-bottom" >
                                                    <label for="surname" class="placeholder">Surname</label>
                                                </div>
                                            </div>

                                            <div class="col-4">
                                                <div class="form-group form-floating-label">
                                                    <input id="other_names_k" type="text" value="{{emp.nextofkin.other_names_k|default_if_none:''}}" name="other_names_k" style="font-weight:bold; font-size: 17px;" class="pb-0 form-control input-border-bottom">
                                                    <label for="other_names_k" class="placeholder">Other Names</label>
                                                </div>
                                            </div>

                                            <div class="col-2">
                                                <div class="form-group form-floating-label">
                                                    <input id="relationship" type="text" name="relationship" value="{{emp.nextofkin.relationship|default_if_none:''}}" style="font-weight:bold; font-size: 16px;" class="pb-0 form-control input-border-bottom" >
                                                    <label for="relationship" class="placeholder">Relationship</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row d-flex justify-content-left text-left pb-3">
                                            <div class="col-2 ">
                                               <div class="form-group form-floating-label">
                                                <select id="gender_k" name="gender_k" class="form-control input-border-bottom pb-1 " >
                                                    <option  hidden>{{emp.nextofkin.gender_k|default_if_none:''}}</option>
                                                    <option>Male</option>
                                                    <option>Female</option>

                                                </select>
                                                <label for="gender_k" class="placeholder">Gender</label>
                                                </div>
                                            </div>

                                            <div class="col-3">
                                                <div class="form-group form-floating-label">
                                                    <input type="tel" id="phone1_k" value="{{emp.nextofkin.mobile_no1_k|default_if_none:''}}" class="pb-0 form-control input-border-bottom" name="mobile_no1_k"  pattern="[0-9]{11}"  >
                                                    <label for="phone1_k" class="placeholder">Mobile No:</label>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <div class="form-group form-floating-label">
                                                    <input type="tel" id="phone2_k" value="{{emp.nextofkin.mobile_no2_k|default_if_none:''}}" class="pb-0 form-control input-border-bottom" name="mobile_no2_k"  pattern="[0-9]{11}" >
                                                    <label for="phone2" class="placeholder">Phone No:</label>
                                                </div>
                                            </div>

                                            <div class="col-3 ">
                                                <div class="form-group form-floating-label">
                                                    <input id="email_addr_k" value="{{emp.nextofkin.email_addr_k|default_if_none:''}}" name="email_addr_k" type="text" class="pb-0 form-control input-border-bottom" >
                                                    <label for="email_addr_k" class="placeholder">Email</label>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row d-flex justify-content-center text-left ">

                                            <div class="col-4">
                                                <div class="form-group form-floating-label">
                                                    <input id="resid_addr_k" type="text" value="{{emp.nextofkin.resid_addr_k|default_if_none:''}}" name="resid_addr_k" class="pb-0 form-control input-border-bottom">
                                                    <label for="resid_addr_k" class="placeholder">Residential Addr:</label>
                                                </div>
                                            </div>

                                            <!-- Guardian Residence City  -->
                                            <div class="col-2 ">
                                                <div class="form-group form-floating-label">
                                                    <select class="form-control input-border-bottom pb-1" id="resid_city_k" name="resid_city_k" >
                                                        <option hidden>{{emp.nextofkin.resid_city_k|default_if_none:''}}</option>
                                                        <option>Port Harcourt</option>
                                                        <option>Ahoada</option>
                                                        <option>Emoha</option>
                                                    </select>
                                                    <label for="resid_city_k" class="placeholder">City Residence:</label>
                                                </div>
                                            </div>

                                            <div class="col-2 ">
                                                <div class="form-group form-floating-label">
                                                    <select class="form-control input-border-bottom pb-1" id="resid_state_k"  name="resid_state_k">
                                                    <option  hidden>{{emp.nextofkin.resid_state_k|default_if_none:''}}</option>
                                                    <option>Rivers</option>
                                                    <option>Bayelsa</option>
                                                    <option>Kwara</option>
                                                    <option>Niger</option>
                                                    <option>Adamawa</option>
                                                    <option>Yola</option>
                                                    <option>Kogi</option>
                                                    <option>Plateau</option>
                                                    </select>
                                                    <label for="resid_state_k" class="placeholder">State Residence</label>
                                                </div>
                                            </div>

                                        </div>
                                    </div>

                                    {% if perms.auth.add_user %}
                                    <!-- Staff Login Details _________________________________________________________ -->
                                    <div class="card-sub mb-0 pb-0">
                                        <div class="row pb-0"><div class="col card-success">Staff Login Details</div></div>
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col nav-tabs pl-5 ml-4 mb-3">
                                            <input id="is_active" name="is_active" type="checkbox" class="form-check-input" {% if emp.user.is_active %} checked {% else %}  {% endif %} >
                                            <label for="is_active" class="font-weight-bold font-italic ">Employee is a User</label>
                                            </div>
                                        </div>
                                        <div class="row justify-content-center ">
                                            <div class="col-3">
                                                <!---
                                                <input id="use_default" type="checkbox" class="pt-3">
                                                <label for="use_default" class="form-group pt-3">Use Default User Name</label>
                                                -->
                                            </div>
                                            <div class="col col-sm-4 pb-0 mb-0">
                                                <div class="form-group ">
                                                    <label for="username" class="placeholder pb-0 mb-0">User Name ( Default )</label>
                                                    <input  id="username" type="text" value="{{emp.user.username|default_if_none:''}}" name="username" readonly  style="font-weight: bold; font-size: 14px;" class="pb-0 pt-0 mb-0 form-control " >
                                                </div>
                                            </div>
                                            <div class="col-3 ">
                                                <label for="sup_user"  class="form-group  pt-3">Is Supper User?</label>
                                                <input id="sup_user" name="is_superuser" type="checkbox" class="pt-3" >
                                            </div>
                                        </div>

                                        <div class="row justify-content-center">
                                            <div class="col col-sm-4  pb-0 mb-0">
                                                <div class="form-group ">
                                                    <label for="password" class="placeholder  pb-0 mb-0 ">Password ( Default )</label>
                                                    <input  id="password" type="text" value="{% if header == 'Employee Update' and emp.user_id %}  * * * * * * {% else %}  {% endif %}" name="password" readonly style="font-weight:bolder; font-size: 14px;" class="pb-0 pt-0 mb-0 form-control  " >

                                                </div>
                                            </div>
                                        </div>

                                        <div class="row justify-content-center">
                                            <div class="col col-sm-4  pb-0 mb-0 ">
                                                <input id="is_staff" name="is_staff" type="checkbox" class="pt-3" {% if emp.user.is_staff %} checked {% else %}  {% endif %}>
                                                <label for="is_staff" class="form-group  pt-3">Is a Staff</label>
                                            </div>
                                        </div>

                                    </div>
                                    {% endif %}
                                    <!-- Card Action Guardian Details-->
                                    <div class="card-action pt-3 pb-2">
                                         <div class="row d-flex justify-content-center text-center">

                                             <div class="col-4 ">
                                                  {% if emp_id is not 0 %}
                                                    <button class="btn btn-full btn-outline-success btn-rounded btn-sm "
                                                            type="submit" name="save_pause" value="save&pause"
                                                            formaction="{% url 'update-employee' emp.id %}" >U P D A T E
                                                    </button>
                                                 {% else %}
                                                    <button class="btn btn-full btn-outline-success btn-rounded btn-sm "
                                                            type="submit" name="save_pause" value="save&pause"
                                                            formaction="{% url 'new-employee' %}" >S A V E
                                                    </button>
                                                 {% endif %}
                                             </div>

                                         </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card-footer pb-1 pt-1">

                        </div>
                    </div>
                </div>
            </form>

             <!-- The Workgroup Modal -->
            <div class="modal fade" id="positionModal">
                <div class="modal-dialog modal-dialog-centered modal-sm">
                    <div class="modal-content">

                        <!-- Modal Header -->
                        <div class="modal-header">
                            <h4 class="modal-title">Add Position</h4>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>

                        <form id="workgroup"  action="" class="" method="POST" enctype="multipart/form-data">
                            {% csrf_token %}
                            <!-- Modal body -->
                            <div class="modal-body ml-4 mr-4">
                                <div class="row ">
                                       <div class="col-lg-12">
                                           <!-- This input is used to identity the form and to get it name in views -->
                                            <input type="hidden" name="frm_name" value="position">

                                            <div class="form-group form-floating-label">
                                                <input id="new_position" type="text" value="{{emp.new_position|default_if_none:''}}"
                                                       name="new_position" class="pb-0 form-control input-border-bottom">
                                                <label for="new_position" class="placeholder">Employee Position:</label>
                                            </div>
                                       </div>
                                  </div>

                            </div>
                            <!-- Modal footer -->
                            <div class="modal-footer">

                                <div class="col-sm-5  pl-1">
                                    <!-- <button type="button" class="btn btn-outline-danger btn-rounded btn-sm" data-dismiss="modal">Close</button> -->
                                </div>
                                <div class="col-sm-7  pl-0 ">
                                    <button id="save-position" type="button" class="btn btn-outline-success btn-rounded btn-sm" >Save</button>
                                </div>

                            </div>
                        </form>

                    </div>
              </div>
            </div>

             <!-- The Department Modal -->
            <div class="modal fade" id="departmentModal">
                <div class="modal-dialog modal-dialog-centered modal-sm">
                    <div class="modal-content">

                        <!-- Modal Header -->
                        <div class="modal-header">
                            <h4 class="modal-title">Add Department</h4>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>

                        <form id="departments"  action="" class="" method="POST" enctype="multipart/form-data">
                            {% csrf_token %}
                            <!-- Modal body -->
                            <div class="modal-body ml-4 mr-4">
                                <div class="row ">
                                       <div class="col-lg-12">
                                           <!-- This input is used to identity the form and to get it name in views -->
                                            <input type="hidden" name="frm_name" value="department">

                                            <div class="form-group form-floating-label">
                                                <input id="new_department" type="text" value="{{emp.new_department|default_if_none:''}}"
                                                       name="new_department" class="pb-0 form-control input-border-bottom">
                                                <label for="new_department" class="placeholder">Employee Department:</label>
                                            </div>
                                       </div>
                                  </div>

                            </div>
                            <!-- Modal footer -->
                            <div class="modal-footer">

                                <div class="col-sm-5  pl-1">
                                    <!-- <button type="button" class="btn btn-outline-danger btn-rounded btn-sm" data-dismiss="modal">Close</button> -->
                                </div>

                                <div class="col-sm-7  pl-0 ">
                                    <button id="save-department" type="button" class="btn btn-outline-success btn-rounded btn-sm" >Save</button>
                                </div>

                            </div>
                        </form>

                    </div>
              </div>
            </div>

        </div>
    </div>


{% endblock content %}


<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

     {% if messages %}
        {% for message in messages %}
            {% if message.tags == 'success'%}
                <script type=text/javascript>toastr.success('{{ message }}', 'Very Good . . . ')</script>
            {% elif message.tags == 'info' %}
                <script type=text/javascript>toastr.info('{{ message }}')</script>
            {% elif message.tags == 'warning' %}
                <script type=text/javascript>toastr.warning('{{ message }}')</script>
            {% elif message.tags == 'error' %}
                <script type=text/javascript>toastr.error('{{ message }}')</script>
            {% endif %}
        {% endfor %}
    {% endif %}


	<!-- Atlantis DEMO methods, don't include it in your project! -->
	<script src="/static/assets/js/setting-demo2.js"></script>  <!-- Script that controlls the settings by the right side -->

<script>

     $(document).ready(function(){
         let header = '{{header}}'  // Assign django template variable to header (jquery variable)
         if ('{{header}}' === 'Employee Entry'){
             $('.clear-img span').text('')
         } else if ('{{emp.emp_pic}}' != 'images/static/default.png') {
             $('.clear-img span').text('Remove')
         }

        // When the browse div (picture) is clicked it trigger the emp-pic click event
         $( ".browse" ).click(function() {
            $( "#emp-pic" ).click();
         });

        // When the picture is change after the emp-pic is triggered by the  browse click event above
         $('input[type="file"]').change(function(e) {
             let fileName = e.target.files[0].name;
             let header = '{{header}}'  // Assign django template variable to header (jquery variable)
             let reader = new FileReader();

             reader.onload = function(e) {
                // get loaded data and render thumbnail.
                if (header === "Employee Entry"){
                    document.getElementById("preview").src = e.target.result;
                    $('.clear-img span').html('Clear Picture')
                } else if (header === "Employee Update" ){
                    document.getElementById("preview_edit").src = e.target.result;
                    $('.clear-img span').html('Remove')
                }
             };
             // read the image file as a data URL.
             reader.readAsDataURL(this.files[0]);
        });

            // Set the picture to default when the clear-img div is clicked
         $( ".clear-img" ).click(function() {
             let fileInput = $('#emp-pic');

             if (header === "Employee Entry"){
                document.getElementById("preview").src = "/static/assets/img/default.png";
                $('#emp_pic_default').val("")
             } else if (header === "Employee Update" ){
                 document.getElementById("preview_edit").src = "/static/assets/img/default.png";
                 $('#emp_pic_default').val("images/static/default.png")
             }
             // Assign new files
             //fileInput[0].files = "/static/assets/img/default.png";
             $('.clear-img span').text('')
         });



         $('#is_active').click(function() {
             let checked = $(this).is(':checked');  // Get the boolean value of cheeckbox (true of false)
             let header = '{{header}}'  // Assign django template variable to header (jquery variable)
             let user_id = '{{emp.user_id}}'
             // alert(user_id)
             // if (user_id === 'None'){alert('No user ID')}
             if (header === "Employee Entry"){
                if ( checked === true){
                    username_password ('generate')
                 } else {
                    username_password ('undo')
                 }
             } else if (header === "Employee Update" && user_id === 'None'){
                 if ( checked === true){
                     username_password ('generate')
                 } else {
                     username_password ('undo')
                 }
             }
        });

         function username_password (action) {
             if (action == 'generate'){

                 let s = $('#surname').val().slice(0,1)
                 let o = $('#other_names').val().slice(0,1)
                 pwd = s+o + $('#staff_no').val().slice(2)  // Concatenate to get the default password
                 uid = $('#staff_no').val()  // Get the staff_no to be use as User Id

                 $('#username').val(uid)
                 $('#password').val(pwd)
                 $( "#is_staff" ).prop( "checked", true );
                 // alert('Generating Employee User name andd Password')

             } else if (action == 'undo'){
                 $('#username').val("")
                 $('#password').val("")
                 $("#is_staff").prop( "checked", false );
                 // alert('Undoing Employee User name andd Password')
             }
         }

         // This function is being Used
         $("#close").click(function(){
             location.href='/employees/staff-list'
         });

          // This function is being Used when the position selection is change or selected
         // The modal form is callup when the selected item is 'Add Position' otherwise an item is selected and displayed
        $('#position').change(function() {
            let item_id = $(this).val();
            let item_name = $("#position option:selected").text();
            // alert('The item Selected from drop down: \n' + 'Item ID: ' +item_id + '\n Item Name: ' + item_name )

            if (item_id == -1){
                $("#position option:selected").text(' ---- Not Valid ---- ')
            } else if (item_id == 0){
                $('#positionModal').modal('show');
            }
        });

        // This Function is being Used
        $("#positionModal").on('shown.bs.modal', function(){
            $(this).find('#new_position').focus();
        });

         // This function is being Used
         // The Click event function to Save New Position of modal form
          $('#save-position').click(function(){

              let form = $(this).closest('form');
              let data = form.serializeArray() // [{'demo: 'value'}]
              //let data = $('#workgroup').serializeArray(); // [{'demo: 'value'}]
              let url = '/employees/modalform-save'

              save_modalform_ajax (url, data)
              $('#positionModal').modal('hide');
          })

          // This function is being Used when the department selection is change or selected
        $('#department').change(function() {
            let item_id = $(this).val();
            let item_name = $("#department option:selected").text();
            // alert('The item Selected from drop down: \n' + 'Item ID: ' +item_id + '\n Item Name: ' + item_name )
            if (item_id == -1){
                $("#department option:selected").text(' ---- Not Valid ---- ')
            } else if (item_id == 0){
                $('#departmentModal').modal('show');
            }
        });

         // This Function is being Used. When the department modal popsup
         // set foucus to the new_department input control
        $("#departmentModal").on('shown.bs.modal', function(){
            $(this).find('#new_department').focus();
        });

         // This function is being Used
         // The Click event function to Save New Position of modal form
         $('#save-department').click(function(){

              let form = $(this).closest('form');
              let data = form.serializeArray() // [{'demo: 'value'}]
              //let data = $('#workgroup').serializeArray(); // [{'demo: 'value'}]
              let url = '/employees/modalform-save'

              save_modalform_ajax (url, data)
             $('#departmentModal').modal('hide');
         })



         function save_modalform_ajax(url, stud_data, x)
         {
             let csrftoken = getCookie('csrftoken'); // Get csrftoken from cookie ( function )

            $.ajax({
                method: "POST",
                url: url,
                headers: {'X-CSRFToken': csrftoken},
                async: "True",
                dataType: "json",
                data:stud_data,
                success: function(response, status)
                {
                    console.log(response);
                    let frm_name = response.data.frm_name

                    if (frm_name == 'position') {
                        if (response.data.error != ''){
                            ajaxAction('failed', response.data.error)
                        } else {
                            let id = response.data.id
                            let position = response.data.position

                            $('#position').prepend(`<option value="${id}">${position}</option>`);
                            $('#position option:selected').val(-1)
                            $("#position option:selected").text('Added: Select It')
                        }
                        // alert('Returned ID: ' + id + "\n Position: " + position)
                    } else if (frm_name == 'department'){
                        if (response.data.error != ''){
                            // alert(response.data.error)
                            data = response.data.error
                            ajaxAction('failed', data)

                        } else {
                            let id = response.data.id
                            let department = response.data.department

                            $('#department').prepend(`<option value="${id}">${department}</option>`);
                            $('#department option:selected').val(-1)
                            $("#department option:selected").text('Added: Select It')
                        }
                    }
                    // ajaxAction('success', data)
                },
                error: function(xhr, status, error){
                    //alert("An Error occured:" + "\n" + xhr.data.error);
                    ajaxAction('failed', data)
                }

            });

         }

         function ajaxAction(status, data){
             if (status == 'success'){
                  swal({
                       icon: "success",
                       timer: 2000,
                       button: {
                           text: "OK",
                           visible: false,

                        }
                    });
             }else{
                 swal({
                       icon: "error",
                        text: data,
                       button: {
                           text: "OK",
                           visible: true,

                        }
                    });
             }

         }



         if (!$('#not-together').is(':checked')) {  //If the CheckBox is NOT Checked
             $(".student-address").hide()
         }

         if ($('#res_addr_l1').val() != ''){  // check if the first control of Student Address has value
             $('#not-together').prop('checked', true);  // Check the CheckBox
             $(".student-address").show()  //  Show inputs for Student Address
         }

         $('#not-together').click(function(e) {         // When the Check box is Click
             if ($('#not-together').is(':checked')) {   //If the CheckBox is Checked
                 $(".student-address").show()  //  Show inputs for Student Address
                 $('#res_addr_l1').attr('required', true);
                 $('#res_addr_l1').focus()

             } else {
                 $(".student-address").hide()   //  Hide inputes for Student Address
                 $('#res_addr_l1').attr('required', false);
                 // alert('Student is living with Guardian?')
             }
		});

        $('#stud_guardian').change(function() {
            let stud_id = $('#reg_id').val();

            let gad_id = $(this).val();
            let guard_name = $("#stud_guardian option:selected").text();
            if(gad_id!=''){
                // alert('Guardian ID:' )
                location.href='/guardians/entry/' + gad_id + '/' + stud_id + '/select-parent'
            }else{
                alert('Guardian is NOT Selected')
            }
        });



        $(".child-edit").click(function(){
        /// your code for click event here ///
            var card_no = $(this).attr('value');

            let stud_id = $('.id-ward'+ card_no).text()
            let stud_name = $('.name-ward'+ card_no).text()
            let related = $('.related-'+ card_no).text()

            relationship(stud_id, stud_name, card_no, related)
        });

        function relationship(stud_id, stud_name, card_no, related){

            swal({
                title: 'Relationship Update',
                text: "{{guardian.surname}} {{guardian.other_names}} is " + related + ' to \n' + stud_name + '\n\n  IS THIS CORRECT?',
                // icon: 'info',
                buttons:{
                    yes: {
                        text: 'YES, Correct !',
                        value: 'yes',
                        className : 'btn btn-outline-success btn-rounded btn-sm'
                    },
                    change: {
                        text : 'NO, Change !',
                        className : 'btn btn-outline-info btn-rounded btn-sm'
                    },
                    remove: {
                        text : 'NO, Remove !',
                        value: 'remove',
                        className : 'btn btn-outline-warning btn-rounded btn-sm'

                    }
                }
            }).then((action) => {
				if (action === 'change') {
                    //alert('Change the Guardian for this Ward')
                    let guard_id = '{{guardian.pk}}'
                    location.href = '/guardians/entry/'+ guard_id + '/' + stud_id + '/new-entry'

				} else if (action === 'remove') {
                    let url = '/guardians/update_relationship'
                    let data = {'stud_id': stud_id, 'card_id': card_no }

                    update_relationship_ajax (url, data)

                } else if (action === 'yes'){
                   swal({
                       icon: "success",
                       timer: 2500,
                       button: {
                           text: "OK",
                           visible: false,

                        }
                    });
                }
            })
        };

         function update_relationship_ajax(url, stud_data, x)
         {
             let csrftoken = getCookie('csrftoken'); // Get csrftoken from cookie ( function )

            $.ajax({
                method: "POST",
                url: url,
                headers: {'X-CSRFToken': csrftoken},
                async: "True",
                dataType: "json",
                data:stud_data,
                success: function(data, status)
                {
                    console.log(data);
                    // var  new_reg = response.new_reg_no;
                    // $( '#reg_no' ).val(new_reg);
                    let x = data.card_id
                    $("#child-" + x).remove();

                    ajaxAction('success', data)
                },
                error: function(xhr, status, error){
                    alert("An Error occured:" + "\n" + error);
                    // let msg = 'An error ocurred:' + '\n' + error;
                    // sweet_alert('Error: Registration No', msg, 'info')
                    ajaxAction('failed', data)
                }

            });

         }



         function getCookie(name) {
            // Get the value of the csrfToken from cookie
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                let cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = jQuery.trim(cookies[i]);
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }


     });


</script>

{% endblock javascripts %}